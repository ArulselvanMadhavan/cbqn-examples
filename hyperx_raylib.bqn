âŸ¨âŸ¨red, white, blackâŸ©â‡color, raylibâŸ©â†râ†â€¢Import "../rayed-bqn/rayed.bqn"
recâ†20
spacing â† 70
ctrlPtOffset â† 100
dims â† 9â€¿9
dims_xy â† dims âˆ¾ 2
gridâ†spacing + (rec+spacing)Ã—>â¥Šâ†•dims
r.window.SetSize 0.5

DrawBezier â† {râ€¿gâ€¿bâ€¿ağ•Š[x1â€¿y1â‹„x2â€¿y2]:
    ctrlPts â† (âˆ¾âŸœ((+âŸœ(5Ã·ctrlPtOffset)â€¿0)â‰((Â¯1Ã—ctrlPtOffset)â€¿0âŠ¸+)))Ë˜ ğ•©
    arg1 â† â‹ˆâ¥Š<Ë˜Ë˜ctrlPts
    args â† arg1âˆ¾4âˆ¾2.0â‹ˆğ•¨
    raylib.DrawSplineBezierCubic args
}â‰1â€¿2

PerFrame â† {ğ•¤
    pos â† r.mouse.GetPos@
    ellipseGrid â† {â‰âŸœ(+âŸœrec)}Ë˜ grid
    {white r.draw.EllipseOutline ğ•©}Ë˜ ellipseGrid
    midpts â† Ã·âŸœ2âˆ˜+Ëâ‰2 ellipseGrid
    midpts_xy â† dims_xy â¥Š midpts
    dim_idx â† 1
    neighbors â† 1âŠ¸â†“â†•âˆ˜(dimsâŠ¸(âŠ‘Ëœ)) dim_idx
    offsets â† midptsxyâŠ¸((âŒ½Ëœ)Ë˜)Â¨ neighbors
    offsetPairings â† midptsxyâŠ¸(>âˆ˜â‹ˆË˜Ë˜)Â¨ offsets
    # lineGrid â† midptsxy >âˆ˜â‹ˆË˜Ë˜ oneoff
    # linesFlag â† midptsxy (Â¯1âŠ¸âŠ‘âˆ˜<)Ë˜Ë˜ oneoff
    # curvesFlag â† Â¬linesFlag
    # curves â† curvesFlag /Ë˜ lineGrid
    # lines â† linesFlag /Ë˜ lineGrid
    curvesFlag â† midptsxyâŠ¸((Â¯1âŠ¸âŠ‘âˆ˜<)Ë˜Ë˜)Â¨ offsets
    curves â† curvesFlag (/Ë˜)Â¨ offsetPairings
    {red DrawBezier ğ•©}Ë˜Â¨ curves
    # {red r.draw.Line ğ•©} lines
} r.draw._withCanvasâŸœblack

PerFrameâ€¢_While_(Â¬r.window.ShouldClose)r.window._openAs "HyperX"
